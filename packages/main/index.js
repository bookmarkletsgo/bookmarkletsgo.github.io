(function(a,b,c){'use strict';function d(a){var b=a.document,c=a.Object;(function(d){d.forEach(function(d){if(d){var e=d.prototype;if(c.prototype.hasOwnProperty.call(e,"append"))return;c.defineProperty(e,"append",{configurable:!0,enumerable:!0,writable:!0,value:function(){var c=Array.prototype.slice.call(arguments),d=b.createDocumentFragment();c.forEach(function(c){var e=c instanceof a.Node;d.appendChild(e?c:b.createTextNode(c+""))}),this.appendChild(d)}})}})})([a.Element,a.Document,a.DocumentFragment])}function e(a){var b=a.Object;(function(a){a.forEach(function(a){if(a){var c=a.prototype;if(b.prototype.hasOwnProperty.call(c,"remove"))return;b.defineProperty(c,"remove",{configurable:!0,enumerable:!0,writable:!0,value:function(){this.parentNode.removeChild(this)}})}})})([a.Element,a.CharacterData,a.DocumentType])}function g(a){var b=a.Element.prototype;b.getAttributeNames||(b.getAttributeNames=function(){for(var a=this.attributes,b=a.length,c=Array(b),d=0;d<b;d++)c[d]=a[d].name;return c})}function h(a,b){for(var c=0;c<b.length;c++)b[c](a)}function i(b,d){var e=!1,f=null,g=Math.random();a[g]=function(){e=!0},b="window["+g+"]();"+b;try{new Function(b)()}catch(a){console.error(a),f=a}c(function(){delete a[g],"function"==typeof d&&d(f,e)})}function j(a,b,c){if(!a)return!1;c=Object.assign({enableScript:!0},c);var f=null;try{f=a.contentDocument||a.document}catch(a){}if(!f||!f.documentElement)return!1;try{f.documentElement.innerHTML=b}catch(a){try{return void f.write(b)}catch(a){return console.log(a),void alert("Do not support this browser or this site.")}}if(c.enableScript){if(s()){var i=a.contentWindow||a;h(i,[g,d,e])}J(K(f.querySelectorAll("script")),function(a){try{var b=f.createElement("script");J(a.getAttributeNames(),function(c){b.setAttribute(c,a.getAttribute(c))}),a.textContent&&(b.textContent=a.textContent),a.remove(),f.head.append(b)}catch(a){console.error(a)}})}}function k(a,b,d){function e(){if(!f){var b=a.contentDocument;return b&&"complete"===b.readyState?void g({type:"readyState:"+b.readyState}):b&&"uninitialized"===b.readyState?void g({type:"readyState:uninitialized"}):void c(e,100)}}var f=!1;d=d||3e3;var g=function(a){f||(console.info("iframe have loaded."),f=!0,"function"==typeof b&&b(a))};p(a,"load",g),c(e,d),c(function(){g({type:"timeout"})},1e4)}function l(a,b,c){k(a,b,c)}function m(a){var b=function(b){console.debug(b+""),prompt("Enter Ctrl+C to copy:",a)};try{navigator.clipboard.writeText(a).then(function(){return alert("done")}).catch(b)}catch(a){b(a)}}var n=Function,f=n.bind.bind(n.call),o=[].includes?f([].includes):function(b,a){return 0<=b.indexOf(a)},p=function(a,b,c,d){if(a)return a.addEventListener(b,c,d||!1),function(){a.removeEventListener(b,c,d||!1)}},q=function(a){return(a.getAttribute("class")||"").split(" ").filter(function(a){return!!a})},r=function(a,b){return a.classList?a.classList.contains(b):o(q(a),b)},s=function(){return"documentMode"in b},t=function(){return"?i="+Math.floor(new Date().getTime()/36e5)},u=function(a){try{return"string"==typeof a?JSON.parse(a):Object(a)}catch(a){return{}}},v="https://bookmarkletsgo.github.io",w="bookmarkletsgo",x="#bookmarkletsgo",y="__BOOKMARKLETSGO",z="origin",A="initialized",B="removeEventListener",C="style",D=Element.prototype,E=function(a,b){return p(a,"message",function(c){console.debug(c);var d=u(c.data),e=c[z];console.info(JSON.stringify({origin:e,from:d.from,type:d.type,content:(d.content||"").slice(0,20)})),d.from===w&&(e===v||e===a.location[z]||e===a[z]||"about:"===e||c.source===a.opener)&&b(d,e)})},F=f(b.createElement,b),G=f(b.querySelector,b),H=f(D.setAttribute);h(a,[d]);var I=f(D.append),J=f([].forEach),K=f([].slice);h(a,[function(a){var b=a.String.prototype;b.includes||(b.includes=function(a,b){if(a instanceof RegExp)throw new TypeError("first argument must not be a RegExp");return void 0===b&&(b=0),-1!==this.indexOf(a,b)})},e,function(a){var b=a.Object;"function"!=typeof b.assign&&b.defineProperty(b,"assign",{value:function(a){if(null===a||a===void 0)throw new TypeError("Cannot convert undefined or null to object");for(var c,d=b(a),e=1;e<arguments.length;e++)if(c=arguments[e],null!==c&&void 0!==c)for(var f in c)b.prototype.hasOwnProperty.call(c,f)&&(d[f]=c[f]);return d},writable:!0,configurable:!0})}]);var L=a[y]||{};a[y]=L;var M=function(){var a=G(x);if(a){var b=G(x).style;b.display="block"===b.display?"none":"block"}else L[A]=!1};if(L[A])M();else{G(x)&&G(x).remove(),L[B]&&(L[B](),L[B]=null);var N=v+"/bookmarklets.html"+t(),O=!1,P=null;L[B]=E(a,function(a){if("iframe_content"===a.type){var b=G(x+" > iframe");if(!b)return;j(b,a.content),function(){var a=b.contentWindow,c=null;try{c=b.contentDocument}catch(b){try{c=a.document}catch(a){}}a&&c&&(!function(){try{return a.eval("1+1"),!1}catch(a){return!0}}()||p(c,"click",function(b){b.preventDefault();var c=b.target;if(r(c,"btn_copy")){var d=c.parentNode.firstChild;m(d.href)}else{var e=c.href;e&&0===e.indexOf("javascript:")&&(e=v+"/bookmarklets.html#run:"+e,e=a.open(e,"_blank"))}},!0))}(),P&&P.close(),W()}else"script"===a.type?i(a.content,function(a){a&&alert("Do not support this site due to Content Security Policy.\nDrag and drop bookmarklets to the 'Bookmarks Bar' of your browser.")}):"iframe_loaded"===a.content&&(O=!0,W())});var Q=F("iframe"),R=function(){console.info("load about:blank"),a.name="parent",H(Q,"src","about:blank"),c(function(){L[A]||V("Please allow \"Open Pop-up Windows\" on this site and try again.")},2e3),P=a.open(N,w),a.focus()};l(Q,function(){c(function(){console.info("recieved message from iframe: "+O),O||(O=!0,R())},50)}),console.info("start load iframe"),H(Q,"src",N),H(Q,C,"width:100%;height:100%;border:0;margin:0;padding:0");var S=F("div");S.id=w,H(S,C,"width:300px;height:300px;position:fixed;top:10px;right:10px;z-index:2147483656;background-color:#f2f2f2;opacity:85%;display:block");var T=F("div");H(T,C,"position:fixed;top:20px;right:40px;"),T.innerHTML="<a href=\"#\" style=\"text-decoration:none\">Done</a>";var U=F("div");H(U,C,"position:absolute;top:20px;left:20px;"),U.innerHTML="<h3>Loading...</h3>",I(S,Q),I(S,T),I(S,U),p(T.firstChild,"click",function(a){a.preventDefault(),L[A]?M():S.remove()}),I(b.body,S);var V=function(a){U.innerHTML="<h3>"+a+"</h3>"},W=function(){L[A]=!0,U.style.display="none"}}})(window,document,setTimeout);