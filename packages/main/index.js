(function(a,b,c){'use strict';function d(a){var b=a.document,c=a.Object;(function(d){d.forEach(function(d){if(d){var e=d.prototype;if(c.prototype.hasOwnProperty.call(e,"append"))return;c.defineProperty(e,"append",{configurable:!0,enumerable:!0,writable:!0,value:function(){var c=Array.prototype.slice.call(arguments),d=b.createDocumentFragment();c.forEach(function(c){var e=c instanceof a.Node;d.appendChild(e?c:b.createTextNode(c+""))}),this.appendChild(d)}})}})})([a.Element,a.Document,a.DocumentFragment])}function e(a){var b=a.Object;(function(a){a.forEach(function(a){if(a){var c=a.prototype;if(b.prototype.hasOwnProperty.call(c,"remove"))return;b.defineProperty(c,"remove",{configurable:!0,enumerable:!0,writable:!0,value:function(){this.parentNode.removeChild(this)}})}})})([a.Element,a.CharacterData,a.DocumentType])}function g(a){var b=a.Element.prototype;b.getAttributeNames||(b.getAttributeNames=function(){for(var a=this.attributes,b=a.length,c=Array(b),d=0;d<b;d++)c[d]=a[d].name;return c})}function h(a,b){for(var c=0;c<b.length;c++)b[c](a)}function i(b,d){var e=!1,f=null,g=Math.random();a[g]=function(){e=!0},b="window["+g+"]();"+b;try{new Function(b)()}catch(a){console.error(a),f=a}c(function(){delete a[g],"function"==typeof d&&d(f,e)})}function j(a,b,c){if(!a)return!1;c=Object.assign({enableScript:!0},c);var f=null;try{f=a.contentDocument||a.document}catch(a){}if(!f||!f.documentElement)return!1;try{f.documentElement.innerHTML=b}catch(a){try{return void f.write(b)}catch(a){return console.log(a),void alert("Do not support this browser or this site.")}}if(c.enableScript){if(s()){var i=a.contentWindow||a;h(i,[g,d,e])}L(M(f.querySelectorAll("script")),function(a){try{var b=f.createElement("script");L(a.getAttributeNames(),function(c){b.setAttribute(c,a.getAttribute(c))}),a.textContent&&(b.textContent=a.textContent),a.remove(),f.head.append(b)}catch(a){console.error(a)}})}}function k(a,b,d){function e(){if(!f){var b=a.contentDocument;return b&&"complete"===b.readyState?void g({type:"readyState:"+b.readyState}):b&&"uninitialized"===b.readyState?void g({type:"readyState:uninitialized"}):void c(e,100)}}var f=!1;d=d||3e3;var g=function(a){f||(console.info("iframe have loaded."),f=!0,"function"==typeof b&&b(a))};p(a,"load",g),c(e,d),c(function(){g({type:"timeout"})},1e4)}function l(a,b,c){k(a,b,c)}function m(a){var b=function(b){console.debug(b+""),prompt("Enter Ctrl+C to copy:",a)};try{navigator.clipboard.writeText(a).then(function(){return alert("done")}).catch(b)}catch(a){b(a)}}var n=Function,f=n.bind.bind(n.call),o=[].includes?f([].includes):function(b,a){return 0<=b.indexOf(a)},p=function(a,b,c,d){if(a)return a.addEventListener(b,c,d||!1),function(){a.removeEventListener(b,c,d||!1)}},q=function(a){return(a.getAttribute("class")||"").split(" ").filter(function(a){return!!a})},r=function(a,b){return a.classList?a.classList.contains(b):o(q(a),b)},s=function(){return"documentMode"in b},t=function(){return"?i="+Math.floor(new Date().getTime()/36e5)},u=function(a){try{return"string"==typeof a?JSON.parse(a):Object(a)}catch(a){return{}}},v="https://bookmarkletsgo.github.io",w="bookmarkletsgo",x="#bookmarkletsgo",y="__BOOKMARKLETSGO",z=v+"/bookmarklets.html",A="origin",B="initialized",C="removeEventListener",D="style",E=Element.prototype,F=9===function(){return b.documentMode||-1}()?function(a,b){b.from=w,a.postMessage(JSON.stringify(b),"*")}:function(a,b){b.from=w,a.postMessage(b,"*")},G=function(a,b){return p(a,"message",function(c){console.debug(c);var d=u(c.data),e=c[A],f=c.source;console.info(JSON.stringify({origin:e,from:d.from,type:d.type,content:(d.content+"").slice(0,30)})),d.from===w&&(e===v||e===a.location[A]||e===a[A]||"about:"===e||f===a.top||a.opener&&(f===a.opener||f===a.opener.top))&&b(d,c)})},H=f(b.createElement,b),I=f(b.querySelector,b),J=f(E.setAttribute);h(a,[d]);var K=f(E.append),L=f([].forEach),M=f([].slice);h(a,[function(a){var b=a.String.prototype;b.startsWith||(b.startsWith=function(a,b){var c=0<b?0|b:0;return this.slice(c,c+a.length)===a})},e,function(a){var b=a.Object;"function"!=typeof b.assign&&b.defineProperty(b,"assign",{value:function(a){if(null===a||a===void 0)throw new TypeError("Cannot convert undefined or null to object");for(var c,d=b(a),e=1;e<arguments.length;e++)if(c=arguments[e],null!==c&&void 0!==c)for(var f in c)b.prototype.hasOwnProperty.call(c,f)&&(d[f]=c[f]);return d},writable:!0,configurable:!0})}]);var N=a[y]||{};a[y]=N;var O=function(){var a=I(x);if(a){var b=I(x).style;b.display="block"===b.display?"none":"block"}else N[B]=!1},P=function(a){a&&F(a,{type:"context",content:{location:{hash:location.hash,host:location.host,hostname:location.hostname,href:location.href,origin:location.origin,pathname:location.pathname,port:location.port,protocal:location.protocal},innerHTML:b.documentElement.innerHTML,title:b.title}})};if(N[B])O();else{I(x)&&I(x).remove(),N[C]&&(N[C](),N[C]=null);var Q=z+t(),R=!1,S=null;N[C]=G(a,function(a,b){if("iframe_content"===a.type){var c=I(x+" > iframe");if(!c)return;j(c,a.content),function(){var a=c.contentWindow,b=null;try{b=c.contentDocument}catch(c){try{b=a.document}catch(a){}}a&&b&&(!function(){try{return a.eval("1+1"),!1}catch(a){return!0}}()||p(b,"click",function(b){b.preventDefault();var c=b.target;if(r(c,"btn_copy")){var d=c.parentNode.firstChild;m(d.href)}else{var e=c.href;if(e&&e.startsWith("javascript:")){var f=a.open(z+"#/run/bookmarklets/"+c.id.slice(15),w+"_run");P(f)}}},!0))}(),S&&S.close(),Z()}else"script"===a.type?i(a.content,function(a){a&&alert("Do not support this site due to Content Security Policy.\nDrag and drop bookmarklets to the 'Bookmarks Bar' of your browser.")}):"iframe_loaded"===a.content?(R=!0,Z()):"opened_window_loaded"===a.content&&P(b.source)});var T=H("iframe"),U=function(){console.info("load about:blank"),a.name="parent",J(T,"src","about:blank"),c(function(){N[B]||Y("Please allow \"Open Pop-up Windows\" on this site and try again.")},2e3),S=a.open(Q,w),a.focus()};l(T,function(){c(function(){console.info("recieved message from iframe: "+R),R||(R=!0,U())},50)}),console.info("start load iframe"),J(T,"src",Q),J(T,D,"width:100%;height:100%;border:0;margin:0;padding:0");var V=H("div");V.id=w,J(V,D,"width:300px;height:300px;position:fixed;top:10px;right:10px;z-index:2147483656;background-color:#f2f2f2;opacity:85%;display:block");var W=H("div");J(W,D,"position:fixed;top:20px;right:40px;"),W.innerHTML="<a href=\"#\" style=\"text-decoration:none\">Done</a>";var X=H("div");J(X,D,"position:absolute;top:20px;left:20px;"),X.innerHTML="<h3>Loading...</h3>",K(V,T),K(V,W),K(V,X),p(W.firstChild,"click",function(a){a.preventDefault(),N[B]?O():V.remove()}),K(b.body,V);var Y=function(a){X.innerHTML="<h3>"+a+"</h3>"},Z=function(){N[B]=!0,X.style.display="none"}}})(window,document,setTimeout);